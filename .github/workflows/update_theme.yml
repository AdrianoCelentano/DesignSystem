name: Sync Design System (Kotlin)

on:
  push:
    paths:
      - 'tokens.json'

# ADD THIS SECTION to enable the manual button
workflow_dispatch:
  inputs:
    reason:
      description: 'Why are you running this?'
      required: false
      default: 'Manual update'

jobs:
  update-theme:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Repo
        uses: actions/checkout@v4

      # INSTALL KOTLIN
      - name: Setup Kotlin
        uses: fwilhe2/setup-kotlin@v1
        with:
          version: 2.0.20 # or latest

      # RUN THE SCRIPT
      - name: Generate Compose Code
        run: kotlin convert_tokens.main.kts

      # CREATE PULL REQUEST
      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "design: update compose theme"
          title: "ðŸŽ¨ Update Design Tokens"
          body: "Auto-generated updates from Figma via Kotlin Script."
          branch: "design-updates"